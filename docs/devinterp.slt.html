<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>devinterp.slt package &mdash; devinterp 0.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=e259d695"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/custom.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}})</script>
        <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="devinterp.optim package" href="devinterp.optim.html" />
    <link rel="prev" title="Welcome to devinterp’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            devinterp
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome to devinterp’s documentation!</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SLT Observables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.callback">devinterp.slt.callback module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.callback.SamplerCallback"><code class="docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.callback.SamplerCallback.finalize"><code class="docutils literal notranslate"><span class="pre">SamplerCallback.finalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.callback.SamplerCallback.sample"><code class="docutils literal notranslate"><span class="pre">SamplerCallback.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.cov">devinterp.slt.cov module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.cov.BetweenLayerCovarianceAccumulator"><code class="docutils literal notranslate"><span class="pre">BetweenLayerCovarianceAccumulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.cov.BetweenLayerCovarianceAccumulator.sample"><code class="docutils literal notranslate"><span class="pre">BetweenLayerCovarianceAccumulator.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.cov.CovarianceAccumulator"><code class="docutils literal notranslate"><span class="pre">CovarianceAccumulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.cov.CovarianceAccumulator.sample"><code class="docutils literal notranslate"><span class="pre">CovarianceAccumulator.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.cov.WithinHeadCovarianceAccumulator"><code class="docutils literal notranslate"><span class="pre">WithinHeadCovarianceAccumulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.cov.WithinHeadCovarianceAccumulator.sample"><code class="docutils literal notranslate"><span class="pre">WithinHeadCovarianceAccumulator.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.gradient">devinterp.slt.gradient module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.gradient.GradientDistribution"><code class="docutils literal notranslate"><span class="pre">GradientDistribution</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.gradient.GradientDistribution.plot"><code class="docutils literal notranslate"><span class="pre">GradientDistribution.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.gradient.GradientDistribution.sample"><code class="docutils literal notranslate"><span class="pre">GradientDistribution.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.llc">devinterp.slt.llc module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.llc.LLCEstimator"><code class="docutils literal notranslate"><span class="pre">LLCEstimator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.llc.LLCEstimator.sample"><code class="docutils literal notranslate"><span class="pre">LLCEstimator.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.llc.OnlineLLCEstimator"><code class="docutils literal notranslate"><span class="pre">OnlineLLCEstimator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.llc.OnlineLLCEstimator.sample"><code class="docutils literal notranslate"><span class="pre">OnlineLLCEstimator.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.loss">devinterp.slt.loss module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.loss.OnlineLossStatistics"><code class="docutils literal notranslate"><span class="pre">OnlineLossStatistics</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.loss.OnlineLossStatistics.loss_hist_by_draw"><code class="docutils literal notranslate"><span class="pre">OnlineLossStatistics.loss_hist_by_draw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.loss.OnlineLossStatistics.sample"><code class="docutils literal notranslate"><span class="pre">OnlineLossStatistics.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.mala">devinterp.slt.mala module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.mala.MalaAcceptanceRate"><code class="docutils literal notranslate"><span class="pre">MalaAcceptanceRate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.mala.MalaAcceptanceRate.num_draws"><code class="docutils literal notranslate"><span class="pre">MalaAcceptanceRate.num_draws</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.mala.MalaAcceptanceRate.num_chains"><code class="docutils literal notranslate"><span class="pre">MalaAcceptanceRate.num_chains</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.mala.MalaAcceptanceRate.temperature"><code class="docutils literal notranslate"><span class="pre">MalaAcceptanceRate.temperature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.mala.MalaAcceptanceRate.learning_rate"><code class="docutils literal notranslate"><span class="pre">MalaAcceptanceRate.learning_rate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.mala.MalaAcceptanceRate.device"><code class="docutils literal notranslate"><span class="pre">MalaAcceptanceRate.device</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.mala.mala_acceptance_probability"><code class="docutils literal notranslate"><span class="pre">mala_acceptance_probability()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.norms">devinterp.slt.norms module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.norms.GradientNorm"><code class="docutils literal notranslate"><span class="pre">GradientNorm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.norms.GradientNorm.sample"><code class="docutils literal notranslate"><span class="pre">GradientNorm.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.norms.NoiseNorm"><code class="docutils literal notranslate"><span class="pre">NoiseNorm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.norms.NoiseNorm.sample"><code class="docutils literal notranslate"><span class="pre">NoiseNorm.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.norms.WeightNorm"><code class="docutils literal notranslate"><span class="pre">WeightNorm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.norms.WeightNorm.sample"><code class="docutils literal notranslate"><span class="pre">WeightNorm.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.sampler">devinterp.slt.sampler module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.sampler.sample"><code class="docutils literal notranslate"><span class="pre">sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.trace">devinterp.slt.trace module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.trace.OnlineTraceStatistics"><code class="docutils literal notranslate"><span class="pre">OnlineTraceStatistics</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.trace.OnlineTraceStatistics.sample"><code class="docutils literal notranslate"><span class="pre">OnlineTraceStatistics.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.trace.OnlineTraceStatistics.sample_at_draw"><code class="docutils literal notranslate"><span class="pre">OnlineTraceStatistics.sample_at_draw()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt.wbic">devinterp.slt.wbic module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#devinterp.slt.wbic.OnlineWBICEstimator"><code class="docutils literal notranslate"><span class="pre">OnlineWBICEstimator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devinterp.slt.wbic.OnlineWBICEstimator.sample"><code class="docutils literal notranslate"><span class="pre">OnlineWBICEstimator.sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-devinterp.slt">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="devinterp.optim.html">Sampling Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="devinterp.utils.html">Utils &amp; Visualisation Methods</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">devinterp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">devinterp.slt package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/devinterp.slt.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="devinterp-slt-package">
<h1>devinterp.slt package<a class="headerlink" href="#devinterp-slt-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-devinterp.slt.callback">
<span id="devinterp-slt-callback-module"></span><h2>devinterp.slt.callback module<a class="headerlink" href="#module-devinterp.slt.callback" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.callback.SamplerCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.callback.</span></span><span class="sig-name descname"><span class="pre">SamplerCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/callback.html#SamplerCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.callback.SamplerCallback" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for creating callbacks used in <a class="reference internal" href="#devinterp.slt.sampler.sample" title="devinterp.slt.sampler.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sampler.sample()</span></code></a>.
Each instantiated callback gets its <code class="code highlight python docutils literal highlight-python"><span class="fm">__call__</span></code> called every sample, and <code class="code highlight python docutils literal highlight-python"><span class="n">finalize</span></code> called at the end of sample (if it exists).
Each callback method can access parameters in <code class="code highlight python docutils literal highlight-python"><span class="nb">locals</span><span class="p">()</span></code>, so there’s no need to pass variables along explicitly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if <code class="code highlight python docutils literal highlight-python"><span class="fm">__call__</span></code> and <code class="code highlight python docutils literal highlight-python"><span class="n">sample</span></code> are not overwritten.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="code highlight python docutils literal highlight-python"><span class="n">mps</span></code> devices might not work for all callbacks.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.callback.SamplerCallback.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/callback.html#SamplerCallback.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.callback.SamplerCallback.finalize" title="Link to this definition"></a></dt>
<dd><p>Gets called at the end of sampling. Can access any variable in <code class="code highlight python docutils literal highlight-python"><span class="nb">locals</span><span class="p">()</span></code> when called. Should be used for calucalting stats over chains, for example average chain loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.callback.SamplerCallback.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/callback.html#SamplerCallback.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.callback.SamplerCallback.sample" title="Link to this definition"></a></dt>
<dd><p>Does not get called automatically, but functions as an interface to easily access stats calculated by the callback.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt.cov">
<span id="devinterp-slt-cov-module"></span><h2>devinterp.slt.cov module<a class="headerlink" href="#module-devinterp.slt.cov" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.cov.BetweenLayerCovarianceAccumulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.cov.</span></span><span class="sig-name descname"><span class="pre">BetweenLayerCovarianceAccumulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_evals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">accessors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/cov.html#BetweenLayerCovarianceAccumulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.cov.BetweenLayerCovarianceAccumulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A CovarianceAccumulator to compute covariance between arbitrary layers. For use with <a class="reference internal" href="#devinterp.slt.sampler.sample" title="devinterp.slt.sampler.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sampler.sample()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to compute covariances on.</p></li>
<li><p><strong>pairs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Named pairs of layers to compute covariances on.</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
<li><p><strong>num_evals</strong> (<em>int</em>) – number of eigenvectors / eigenvalues to compute. Default is 3</p></li>
<li><p><strong>accessors</strong> (<em>Callable</em><em>[</em><em>[</em><em>nn.Module</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Functions to access attention head weights.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.cov.BetweenLayerCovarianceAccumulator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/cov.html#BetweenLayerCovarianceAccumulator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.cov.BetweenLayerCovarianceAccumulator.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict with named_pairs keys, with corresponding values <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;evals&quot;</span><span class="p">:</span> <span class="n">eigenvalues_of_cov_matrix</span><span class="p">,</span> <span class="s2">&quot;evecs&quot;</span><span class="p">:</span> <span class="n">eigenvectors_of_cov_matrix</span><span class="p">,</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span> <span class="n">cov_matrix</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">covariance_accumulator_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.cov.CovarianceAccumulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.cov.</span></span><span class="sig-name descname"><span class="pre">CovarianceAccumulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accessors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_evals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/cov.html#CovarianceAccumulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.cov.CovarianceAccumulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>A callback to iteratively compute and store the covariance matrix of model weights.
For passing along to <a class="reference internal" href="#devinterp.slt.sampler.sample" title="devinterp.slt.sampler.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sampler.sample()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_weights</strong> (<em>int</em>) – Total number of weights.</p></li>
<li><p><strong>accessors</strong> (<em>List</em><em>[</em><em>Callable</em><em>[</em><em>[</em><em>nn.Module</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em>) – Functions to access model weights.</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
<li><p><strong>num_evals</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of eigenvalues to compute. Default is 3</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.cov.CovarianceAccumulator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/cov.html#CovarianceAccumulator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.cov.CovarianceAccumulator.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;evals&quot;</span><span class="p">:</span> <span class="n">eigenvalues_of_cov_matrix</span><span class="p">,</span> <span class="s2">&quot;evecs&quot;</span><span class="p">:</span> <span class="n">eigenvectors_of_cov_matrix</span><span class="p">,</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span> <span class="n">cov_matrix</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">covariance_accumulator_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.cov.WithinHeadCovarianceAccumulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.cov.</span></span><span class="sig-name descname"><span class="pre">WithinHeadCovarianceAccumulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_weights_per_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accessors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_evals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/cov.html#WithinHeadCovarianceAccumulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.cov.WithinHeadCovarianceAccumulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A CovarianceAccumulator to compute covariance within attention heads.
For use with <a class="reference internal" href="#devinterp.slt.sampler.sample" title="devinterp.slt.sampler.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sampler.sample()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_heads</strong> (<em>int</em>) – The number of attention heads.</p></li>
<li><p><strong>num_weights_per_head</strong> (<em>int</em>) – The number of weights per attention head.</p></li>
<li><p><strong>accessors</strong> (<em>List</em><em>[</em><em>Callable</em><em>[</em><em>[</em><em>nn.Module</em><em>]</em><em>, </em><em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>...</em><em>]</em><em>]</em><em>]</em>) – Functions to access attention head weights.</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
<li><p><strong>num_evals</strong> (<em>int</em><em>, </em><em>optional</em>) – number of eigenvectors / eigenvalues to compute. Default is 3</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.cov.WithinHeadCovarianceAccumulator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/cov.html#WithinHeadCovarianceAccumulator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.cov.WithinHeadCovarianceAccumulator.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;evals&quot;</span><span class="p">:</span> <span class="n">array_of_eigenvalues_of_cov_matrix_layer_idx_head_idx</span><span class="p">,</span> <span class="s2">&quot;evecs&quot;</span><span class="p">:</span> <span class="n">array_of_eigenvectors_of_cov_matrix_layer_idx_head_idx</span><span class="p">,</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span> <span class="n">array_of_cov_matrices_layer_idx_head_idx</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">covariance_accumulator_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt.gradient">
<span id="devinterp-slt-gradient-module"></span><h2>devinterp.slt.gradient module<a class="headerlink" href="#module-devinterp.slt.gradient" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.gradient.GradientDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.gradient.</span></span><span class="sig-name descname"><span class="pre">GradientDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/gradient.html#GradientDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.gradient.GradientDistribution" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for plotting the distribution of gradients as a function of draws. Does some magic to automatically adjust bins as more draws are taken.
For use with <a class="reference internal" href="#devinterp.slt.sampler.sample" title="devinterp.slt.sampler.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sampler.sample()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_draws</strong> (<em>int</em>) – Number of samples to draw (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of chains to run (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>min_bins</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of bins for histogram approximation. Default is 20</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of parameter names to track. If None, all parameters are tracked. Default is None</p></li>
<li><p><strong>device</strong> (<em>: str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If gradients are not computed before calling this callback.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.gradient.GradientDistribution.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/gradient.html#GradientDistribution.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.gradient.GradientDistribution.plot" title="Link to this definition"></a></dt>
<dd><p>Plots the gradient distribution for a specific parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_name</strong> (<em>str</em>) – the name of the parameter plot gradients for.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – The color to plot gradient bins in. Default is blue</p></li>
<li><p><strong>plot_zero</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the line through y=0. Default is True</p></li>
<li><p><strong>chain</strong> (<em>int</em><em>, </em><em>optional</em>) – The model to compute covariances on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None, but shows the denisty gradient bins over sampling steps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.gradient.GradientDistribution.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/gradient.html#GradientDistribution.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.gradient.GradientDistribution.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;gradient/distributions&quot;</span><span class="p">:</span> <span class="n">grad_dists</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">gradient_dist_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt.llc">
<span id="devinterp-slt-llc-module"></span><h2>devinterp.slt.llc module<a class="headerlink" href="#module-devinterp.slt.llc" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.llc.LLCEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.llc.</span></span><span class="sig-name descname"><span class="pre">LLCEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/llc.html#LLCEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.llc.LLCEstimator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for estimating the Local Learning Coefficient (LLC) in a rolling fashion during a sampling process.
It calculates the LLC based on the average loss across draws for each chain:</p>
<p><div class="math notranslate nohighlight">
\[LLC = \textrm{T} * (\textrm{avg_loss} - \textrm{init_loss})\]</div>
</p>
<p>For use with <a class="reference internal" href="#devinterp.slt.sampler.sample" title="devinterp.slt.sampler.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sampler.sample()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>init_loss</cite> gets set inside <code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sample()</span></code>. It can be passed as an argument to that function,
and if not passed will be the average loss of the supplied model over <cite>num_chains</cite> batches.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_draws</strong> (<em>int</em>) – Number of samples to draw (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of chains to run (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>temperature</strong> (<em>int</em>) – Temperature, float (default: 1., set by sample() to utils.optimal_temperature(dataloader)=len(batch_size)/np.log(len(batch_size)))</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.llc.LLCEstimator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/llc.html#LLCEstimator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.llc.LLCEstimator.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;llc/mean&quot;</span><span class="p">:</span> <span class="n">llc_mean</span><span class="p">,</span> <span class="s2">&quot;llc/std&quot;</span><span class="p">:</span> <span class="n">llc_std</span><span class="p">,</span> <span class="s2">&quot;llc-chain/</span><span class="si">{i}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">llc_trace_per_chain</span><span class="p">,</span> <span class="s2">&quot;loss/trace&quot;</span><span class="p">:</span> <span class="n">loss_trace_per_chain</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">llc_estimator_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.llc.OnlineLLCEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.llc.</span></span><span class="sig-name descname"><span class="pre">OnlineLLCEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/llc.html#OnlineLLCEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.llc.OnlineLLCEstimator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for estimating the Local Learning Coefficient (LLC) in an online fashion during a sampling process.
It calculates LLCs using the same formula as <a class="reference internal" href="#devinterp.slt.llc.LLCEstimator" title="devinterp.slt.llc.LLCEstimator"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.llc.LLCEstimator()</span></code></a>, but continuously and including means and std across draws (as opposed to just across chains).
For use with <a class="reference internal" href="#devinterp.slt.sampler.sample" title="devinterp.slt.sampler.sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sampler.sample()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>init_loss</cite> gets set inside <code class="xref py py-func docutils literal notranslate"><span class="pre">devinterp.slt.sample()</span></code>. It can be passed as an argument to that function,
and if not passed will be the average loss of the supplied model over <cite>num_chains</cite> batches.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_draws</strong> (<em>int</em>) – Number of samples to draw (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of chains to run (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>temperature</strong> (<em>int</em>) – Temperature, float (default: 1., set by sample() to utils.optimal_temperature(dataloader)=len(batch_size)/np.log(len(batch_size)))</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.llc.OnlineLLCEstimator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/llc.html#OnlineLLCEstimator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.llc.OnlineLLCEstimator.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;llc/means&quot;</span><span class="p">:</span> <span class="n">llc_means</span><span class="p">,</span> <span class="s2">&quot;llc/stds&quot;</span><span class="p">:</span> <span class="n">llc_stds</span><span class="p">,</span> <span class="s2">&quot;llc/trace&quot;</span><span class="p">:</span> <span class="n">llc_trace_per_chain</span><span class="p">,</span> <span class="s2">&quot;loss/trace&quot;</span><span class="p">:</span> <span class="n">loss_trace_per_chain</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">llc_estimator_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt.loss">
<span id="devinterp-slt-loss-module"></span><h2>devinterp.slt.loss module<a class="headerlink" href="#module-devinterp.slt.loss" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.loss.OnlineLossStatistics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.loss.</span></span><span class="sig-name descname"><span class="pre">OnlineLossStatistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#devinterp.slt.llc.OnlineLLCEstimator" title="devinterp.slt.llc.OnlineLLCEstimator"><span class="pre">OnlineLLCEstimator</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/loss.html#OnlineLossStatistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.loss.OnlineLossStatistics" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Derivative callback that computes various loss statistics for <a class="reference internal" href="#devinterp.slt.llc.OnlineLLCEstimator" title="devinterp.slt.llc.OnlineLLCEstimator"><code class="xref py py-func docutils literal notranslate"><span class="pre">OnlineLLCEstimator()</span></code></a>. Must
be called after the base <a class="reference internal" href="#devinterp.slt.llc.OnlineLLCEstimator" title="devinterp.slt.llc.OnlineLLCEstimator"><code class="xref py py-func docutils literal notranslate"><span class="pre">OnlineLLCEstimator()</span></code></a> has been called at each draw.</p>
<p>See <a class="reference external" href="https://www.github.com/timaeus-research/devinterp/blob/main/examples/diagnostics.ipynb">the diagnostics notebook</a> <a class="reference external" href="https://colab.research.google.com/github/timaeus-research/devinterp/blob/main/examples/diagnostics.ipynb"><img alt="colab5" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> for examples on how to use this to diagnose your sample health.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>base_callback</strong> (<a class="reference internal" href="#devinterp.slt.llc.OnlineLLCEstimator" title="devinterp.slt.llc.OnlineLLCEstimator"><code class="xref py py-func docutils literal notranslate"><span class="pre">OnlineLLCEstimator()</span></code></a>) – Base callback that computes original loss metric.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Requires losses to be computed first, so call using f.e. <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">llc_estimator_instance</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">online_loss_stats_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code></p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.loss.OnlineLossStatistics.loss_hist_by_draw">
<span class="sig-name descname"><span class="pre">loss_hist_by_draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/loss.html#OnlineLossStatistics.loss_hist_by_draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.loss.OnlineLossStatistics.loss_hist_by_draw" title="Link to this definition"></a></dt>
<dd><p>Plots a histogram of chain losses for a given draw index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>draw</strong> (<em>int</em><em>, </em><em>optional</em>) – Draw index to plot histogram for. Default is 0</p></li>
<li><p><strong>bins</strong> (<em>int</em><em>, </em><em>optional</em>) – number of histogram bins. Default is 10</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.loss.OnlineLossStatistics.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/loss.html#OnlineLossStatistics.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.loss.OnlineLossStatistics.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;loss/percent_neg_steps&quot;</span><span class="p">:</span> <span class="n">percent_neg_steps</span><span class="p">,</span> <span class="s2">&quot;loss/percent_mean_neg_steps&quot;</span><span class="p">:</span> <span class="n">percent_mean_neg_steps</span><span class="p">,</span> <span class="s2">&quot;loss/percent_thresholded_neg_steps&quot;</span><span class="p">:</span> <span class="n">percent_thresholded_neg_steps</span><span class="p">,</span> <span class="s2">&quot;loss/z_scores&quot;</span><span class="p">:</span> <span class="n">z_scores</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">llc_estimator_instance</span><span class="p">,</span> <span class="n">online_loss_stats_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt.mala">
<span id="devinterp-slt-mala-module"></span><h2>devinterp.slt.mala module<a class="headerlink" href="#module-devinterp.slt.mala" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.mala.MalaAcceptanceRate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.mala.</span></span><span class="sig-name descname"><span class="pre">MalaAcceptanceRate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/mala.html#MalaAcceptanceRate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.mala.MalaAcceptanceRate" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for computing MALA acceptance rate.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="devinterp.slt.mala.MalaAcceptanceRate.num_draws">
<span class="sig-name descname"><span class="pre">num_draws</span></span><a class="headerlink" href="#devinterp.slt.mala.MalaAcceptanceRate.num_draws" title="Link to this definition"></a></dt>
<dd><p>Number of samples to draw. (should be identical to param passed to sample())</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="devinterp.slt.mala.MalaAcceptanceRate.num_chains">
<span class="sig-name descname"><span class="pre">num_chains</span></span><a class="headerlink" href="#devinterp.slt.mala.MalaAcceptanceRate.num_chains" title="Link to this definition"></a></dt>
<dd><p>Number of chains to run. (should be identical to param passed to sample())</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="devinterp.slt.mala.MalaAcceptanceRate.temperature">
<span class="sig-name descname"><span class="pre">temperature</span></span><a class="headerlink" href="#devinterp.slt.mala.MalaAcceptanceRate.temperature" title="Link to this definition"></a></dt>
<dd><p>Temperature used to calculate the LLC.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="devinterp.slt.mala.MalaAcceptanceRate.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#devinterp.slt.mala.MalaAcceptanceRate.learning_rate" title="Link to this definition"></a></dt>
<dd><p>Learning rate of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="devinterp.slt.mala.MalaAcceptanceRate.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#devinterp.slt.mala.MalaAcceptanceRate.device" title="Link to this definition"></a></dt>
<dd><p>Device to perform computations on, e.g., ‘cpu’ or ‘cuda’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.device, str]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="devinterp.slt.mala.mala_acceptance_probability">
<span class="sig-prename descclassname"><span class="pre">devinterp.slt.mala.</span></span><span class="sig-name descname"><span class="pre">mala_acceptance_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prev_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_grads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_grads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/mala.html#mala_acceptance_probability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.mala.mala_acceptance_probability" title="Link to this definition"></a></dt>
<dd><p>Calculate the acceptance probability for a MALA transition. Parameters and
gradients can either all be given as a tensor (all of the same shape) or
all as lists of tensors (eg the parameters of a Module).</p>
<p>Args:
prev_params: The previous point in parameter space.
prev_grads: Gradient of the prev point in parameter space.
prev_loss: Loss of the previous point in parameter space.
current_params: The current point in parameter space.
current_grads: Gradient of the current point in parameter space.
current_loss: Loss of the current point in parameter space.
learning_rate (float): Learning rate of the model.</p>
<p>Returns:
float: Acceptance probability for the proposed transition.</p>
</dd></dl>

</section>
<section id="module-devinterp.slt.norms">
<span id="devinterp-slt-norms-module"></span><h2>devinterp.slt.norms module<a class="headerlink" href="#module-devinterp.slt.norms" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.norms.GradientNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.norms.</span></span><span class="sig-name descname"><span class="pre">GradientNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/norms.html#GradientNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.norms.GradientNorm" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for computing the norm of the gradients of the optimizer / sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_draws</strong> (<em>int</em>) – Number of samples to draw (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of chains to run (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>p_norm</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of the norm to be computed (e.g., 2 for Euclidean norm). Default is 2</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.norms.GradientNorm.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/norms.html#GradientNorm.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.norms.GradientNorm.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;gradient_norm/trace&quot;</span><span class="p">:</span> <span class="n">gradient_norms</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">grad_norm_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.norms.NoiseNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.norms.</span></span><span class="sig-name descname"><span class="pre">NoiseNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/norms.html#NoiseNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.norms.NoiseNorm" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for computing the norm of the noise added in the optimizer / sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_draws</strong> (<em>int</em>) – Number of samples to draw (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of chains to run (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>p_norm</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of the norm to be computed (e.g., 2 for Euclidean norm). Default is 2</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.norms.NoiseNorm.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/norms.html#NoiseNorm.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.norms.NoiseNorm.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;noise_norm/trace&quot;</span><span class="p">:</span> <span class="n">noise_norms</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">noise_norm_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.norms.WeightNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.norms.</span></span><span class="sig-name descname"><span class="pre">WeightNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/norms.html#WeightNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.norms.WeightNorm" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for computing the norm of the weights over the sampling process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_draws</strong> (<em>int</em>) – Number of samples to draw (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of chains to run (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>p_norm</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of the norm to be computed (e.g., 2 for Euclidean norm). Default is 2</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.norms.WeightNorm.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/norms.html#WeightNorm.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.norms.WeightNorm.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;weight_norm/trace&quot;</span><span class="p">:</span> <span class="n">weight_norms</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">weight_norm_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt.sampler">
<span id="devinterp-slt-sampler-module"></span><h2>devinterp.slt.sampler module<a class="headerlink" href="#module-devinterp.slt.sampler" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="devinterp.slt.sampler.sample">
<span class="sig-prename descclassname"><span class="pre">devinterp.slt.sampler.</span></span><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model:</span> <span class="pre">~torch.nn.modules.module.Module,</span> <span class="pre">loader:</span> <span class="pre">~torch.utils.data.dataloader.DataLoader,</span> <span class="pre">callbacks:</span> <span class="pre">~typing.List[~devinterp.slt.callback.SamplerCallback],</span> <span class="pre">evaluate:</span> <span class="pre">~typing.Callable[[~torch.nn.modules.module.Module,</span> <span class="pre">~torch.Tensor],</span> <span class="pre">~devinterp.utils.Outputs</span> <span class="pre">|</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~torch.Tensor]</span> <span class="pre">|</span> <span class="pre">~typing.Tuple[~torch.Tensor,</span> <span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~torch.Tensor]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">sampling_method:</span> <span class="pre">~typing.Type[~torch.optim.optimizer.Optimizer]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'devinterp.optim.sgld.SGLD'&gt;,</span> <span class="pre">optimizer_kwargs:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">~typing.Literal['adaptive']]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">num_draws:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100,</span> <span class="pre">num_chains:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">num_burnin_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">num_steps_bw_draws:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">init_loss:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">grad_accum_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">cores:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">seed:</span> <span class="pre">~typing.List[int]</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">device:</span> <span class="pre">~torch.device</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">device(type='cpu'),</span> <span class="pre">verbose:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">optimize_over_per_model_param:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~typing.List[bool]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/sampler.html#sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.sampler.sample" title="Link to this definition"></a></dt>
<dd><p>Sample model weights using a given sampling_method, supporting multiple chains/cores,
and calculate the observables (loss, llc, etc.) for each callback passed along.
The <code class="code highlight python docutils literal highlight-python"><span class="n">update</span></code>, <code class="code highlight python docutils literal highlight-python"><span class="n">finalize</span></code> and <code class="code highlight python docutils literal highlight-python"><span class="n">sample</span></code> methods of each <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-func docutils literal notranslate"><span class="pre">SamplerCallback()</span></code></a> are called
during sampling, after sampling, and at <code class="code highlight python docutils literal highlight-python"><span class="n">sampler_callback_object</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span></code> respectively.</p>
<p>After calling this function, the stats of interest live in the callback object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The neural network model.</p></li>
<li><p><strong>loader</strong> (<em>DataLoader</em>) – DataLoader for input data.</p></li>
<li><p><strong>evaluate</strong> (<em>EvaluateFn</em>) – Maps a model and batch of data to an object with a loss attribute.</p></li>
<li><p><strong>callbacks</strong> (<em>list</em><em>[</em><a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><em>SamplerCallback</em></a><em>]</em>) – list of callbacks, each of type SamplerCallback</p></li>
<li><p><strong>sampling_method</strong> (<em>torch.optim.Optimizer</em><em>, </em><em>optional</em>) – Sampling method to use (a PyTorch optimizer under the hood). Default is SGLD</p></li>
<li><p><strong>optimizer_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the PyTorch optimizer (used as sampler here). Default is None (using standard SGLD parameters as defined in the SGLD class)</p></li>
<li><p><strong>num_draws</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to draw. Default is 100</p></li>
<li><p><strong>num_chains</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of chains to run. Default is 10</p></li>
<li><p><strong>num_burnin_steps</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of burn-in steps before sampling. Default is 0</p></li>
<li><p><strong>num_steps_bw_draws</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps between each draw. Default is 1</p></li>
<li><p><strong>init_loss</strong> (<em>float</em><em>, </em><em>optional</em>) – Initial loss for use in <cite>LLCEstimator</cite> and <cite>OnlineLLCEstimator</cite></p></li>
<li><p><strong>cores</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of cores for parallel execution. Default is 1</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed(s) for sampling. Each chain gets a different (deterministic) seed if this is passed. Default is None</p></li>
<li><p><strong>device</strong> (<em>str</em><em> or </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to print sample chain progress. Default is True</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – if derivative callbacks (f.e. <a class="reference internal" href="#devinterp.slt.loss.OnlineLossStatistics" title="devinterp.slt.loss.OnlineLossStatistics"><code class="xref py py-func docutils literal notranslate"><span class="pre">OnlineLossStatistics()</span></code></a>) are passed before base callbacks (f.e. <a class="reference internal" href="#devinterp.slt.llc.OnlineLLCEstimator" title="devinterp.slt.llc.OnlineLLCEstimator"><code class="xref py py-func docutils literal notranslate"><span class="pre">OnlineLLCEstimator()</span></code></a>)</p></li>
<li><p><strong>Warning</strong> – if num_burnin_steps &lt; num_draws</p></li>
<li><p><strong>Warning</strong> – if num_draws &gt; len(loader)</p></li>
<li><p><strong>Warning</strong> – if using seeded runs</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None (access LLCs or other observables through <cite>callback_object.sample()</cite>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-devinterp.slt.trace">
<span id="devinterp-slt-trace-module"></span><h2>devinterp.slt.trace module<a class="headerlink" href="#module-devinterp.slt.trace" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.trace.OnlineTraceStatistics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.trace.</span></span><span class="sig-name descname"><span class="pre">OnlineTraceStatistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><span class="pre">SamplerCallback</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/trace.html#OnlineTraceStatistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.trace.OnlineTraceStatistics" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Derivative callback that computes mean/std statistics of a specified trace online. Must be called after the base callback has been called at each draw.</p>
<p>See <a class="reference external" href="https://www.github.com/timaeus-research/devinterp/blob/main/examples/diagnostics.ipynb">the diagnostics notebook</a> <a class="reference external" href="https://colab.research.google.com/github/timaeus-research/devinterp/blob/main/examples/diagnostics.ipynb"><img alt="colab6" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> for examples on how to use this to diagnose your sample health.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_callback</strong> (<a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-func docutils literal notranslate"><span class="pre">SamplerCallback()</span></code></a>) – Base callback that computes some metric.</p></li>
<li><p><strong>attribute</strong> (<em>str</em>) – Name of attribute to compute which mean/std statistics of.</p></li>
<li><p><strong>device</strong> (<em>str</em><em> | </em><em>torch.device</em><em>, </em><em>optional</em>) – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p>ValueError if underlying trace does not have the requested <code class="code highlight python docutils literal highlight-python"><span class="n">attribute</span></code>, <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> or <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Requires base trace stats to be computed first, so call using f.e. <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">weight_norm_instance</span><span class="p">,</span> <span class="n">online_trace_stats_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code></p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.trace.OnlineTraceStatistics.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/trace.html#OnlineTraceStatistics.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.trace.OnlineTraceStatistics.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/chain/mean&quot;</span><span class="p">:</span> <span class="n">mean_attribute_by_chain</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/chain/std&quot;</span><span class="p">:</span> <span class="n">std_attribute_by_chain</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/draw/mean&quot;</span><span class="p">:</span> <span class="n">mean_attribute_by_draw</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/draw/std&quot;</span><span class="p">:</span> <span class="n">std_attribute_by_draw</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">some_thing_to_calc_stats_of</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">trace_stats_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.trace.OnlineTraceStatistics.sample_at_draw">
<span class="sig-name descname"><span class="pre">sample_at_draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/trace.html#OnlineTraceStatistics.sample_at_draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.trace.OnlineTraceStatistics.sample_at_draw" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>draw</strong> (<em>int</em><em>, </em><em>optional</em>) – draw index to return stats at. Default is -1</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/chain/mean&quot;</span><span class="p">:</span> <span class="n">mean_attribute_of_draw_by_chain</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/chain/std&quot;</span><span class="p">:</span> <span class="n">std_attribute_of_draw_by_chain</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/draw/mean&quot;</span><span class="p">:</span> <span class="n">mean_attribute_of_draw</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{self.attribute}</span><span class="s2">/draw/std&quot;</span><span class="p">:</span> <span class="n">std_attribute_of_draw</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">some_thing_to_calc_stats_of</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">trace_stats_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt.wbic">
<span id="devinterp-slt-wbic-module"></span><h2>devinterp.slt.wbic module<a class="headerlink" href="#module-devinterp.slt.wbic" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="devinterp.slt.wbic.OnlineWBICEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">devinterp.slt.wbic.</span></span><span class="sig-name descname"><span class="pre">OnlineWBICEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/wbic.html#OnlineWBICEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.wbic.OnlineWBICEstimator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#devinterp.slt.callback.SamplerCallback" title="devinterp.slt.callback.SamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerCallback</span></code></a></p>
<p>Callback for estimating the Widely Applicable Bayesian Information Criterion (WBIC) in an online fashion.
The WBIC used here is just <span class="math notranslate nohighlight">\(n * (\textrm{average sampled loss})\)</span>. (Watanabe, 2013)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_draws</strong> (<em>int</em>) – Number of samples to draw (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_draws</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of chains to run (should be identical to <code class="code highlight python docutils literal highlight-python"><span class="n">num_chains</span></code> passed to <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span></code>)</p></li>
<li><p><strong>n</strong> – Number of samples used to calculate the wbic.</p></li>
<li><p><strong>n</strong> – int</p></li>
<li><p><strong>device</strong> – Device to perform computations on, e.g., ‘cpu’ or ‘cuda’. Default is ‘cpu’</p></li>
<li><p><strong>device</strong> – str | torch.device, optional</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="devinterp.slt.wbic.OnlineWBICEstimator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/devinterp/slt/wbic.html#OnlineWBICEstimator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#devinterp.slt.wbic.OnlineWBICEstimator.sample" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict <code class="code highlight python docutils literal highlight-python"><span class="p">{</span><span class="s2">&quot;wbic/means&quot;</span><span class="p">:</span> <span class="n">wbic_means</span><span class="p">,</span> <span class="s2">&quot;wbic/stds&quot;</span><span class="p">:</span> <span class="n">wbic_stds</span><span class="p">,</span> <span class="s2">&quot;wbic/trace&quot;</span><span class="p">:</span> <span class="n">wbic_trace_per_chain</span><span class="p">,</span> <span class="s2">&quot;loss/trace&quot;</span><span class="p">:</span> <span class="n">loss_trace_per_chain</span><span class="p">}</span></code>. (Only after running <code class="code highlight python docutils literal highlight-python"><span class="n">devinterp</span><span class="o">.</span><span class="n">slt</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="n">wbic_estimator_instance</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span></code>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-devinterp.slt">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-devinterp.slt" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to devinterp’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="devinterp.optim.html" class="btn btn-neutral float-right" title="devinterp.optim package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Van Wingerden et al..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>